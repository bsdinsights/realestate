<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <report
            id="bsd_bao_gia_in"
            model="bsd.bao_gia"
            string="Báo giá"
            report_type="qweb-html"
            name="bsd_kinh_doanh.bsd_bao_gia_view"
            file="bsd_kinh_doanh.bsd_bao_gia_view"
            attachment_use="True"
            attachment="(object.state in ('open','paid')) and
                ('INV'+(object.number or '').replace('/','')+'.pdf')"
        />

        <template id="bsd_external_layout_standard">
            <t t-if="not o" t-set="o" t-value="doc"/>

            <t t-if="not company">
                <!-- Multicompany -->
                <t t-if="company_id">
                    <t t-set="company" t-value="company_id"/>
                </t>
                <t t-elif="o and 'company_id' in o">
                    <t t-set="company" t-value="o.company_id.sudo()"/>
                </t>
                <t t-else="else">
                    <t t-set="company" t-value="res_company"/>
                </t>
            </t>
            <t t-esc="company.update_scss()"/>
            <div class="header">
                <div class="row">
                    <div class="col-3 mb4">
                        <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="max-height: 100px;" alt="Logo"/>
                    </div>
                    <div class="col-9 text-right">
                        <div t-field="company.partner_id"
                        t-options='{"widget": "contact", "fields": ["address", "name","phone"],"no_marker": true}'/>
                    </div>
                </div>

                <div class="row zero_min_height">
                    <div class="col-12">
                        <div style="border-bottom: 1px solid black;"/>
                    </div>
                </div>

            </div>

            <div class="article o_report_layout_standard"  t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
                <t t-call="web.address_layout"/>
                <t t-raw="0"/>
            </div>
        </template>

        <template id="bsd_bao_gia_view">
            <t t-call="web.html_container">
                <t t-foreach="docs" t-as="doc">
                    <t t-call="web.external_layout">
                    <div class="page">
                        <!-- tên phiếu báo giá-->
                        <div class="row">
                          <div class="col-3"/>
                          <div class="col-6">
                            <h2 style="text-align:center;margin-top: 22px">PHIẾU TÍNH GIÁ</h2>
                          </div>
                          <div class="col-3"/>
                        </div>
                        <!--Ngày in báo giá-->
                        <div class="row">
                          <div class="col-6"/>
                          <div class="col-6">
                            <div style="text-align:right">
                              <span>Ngày: </span>
                              <span t-field="doc.bsd_ngay_in_bg"/>
                            </div>
                          </div>
                        </div>
                        <!--Thông tin căn hộ-->
                        <div class="row">
                            <table class="table table-bordered"
                                   style="table-layout:fixed;border: 3px !important; border-style: solid !important; border-color: #000000 !important;" >
                              <thead>
                                  <tr class="text-center">
                                      <th>
                                            Căn hộ
                                      </th>
                                      <th>
                                            Loại căn hộ
                                      </th>
                                      <th>
                                            Diện tích tim tường
                                      </th>
                                      <th>
                                            Diện tích thông thủy
                                      </th>
                                      <th>
                                            Điều kiện bàn giao
                                      </th>
                                  </tr>
                              </thead>
                              <tbody>
                                <tr class="text-center">
                                  <td><div t-esc="doc.bsd_unit_id.bsd_ten_unit"/></td>
                                  <td><div t-esc="doc.bsd_unit_id.bsd_loai_sp_id.bsd_ma_nhom"/></td>
                                  <td><div t-esc="doc.bsd_dt_xd"/></td>
                                  <td><div t-esc="doc.bsd_dt_sd"/></td>
                                  <td><div></div></td>
                                </tr>
                              </tbody>
                            </table>
                        </div>
                        <!--Chi tiết giá bán-->
                        <div class="row">
                          <table class="table table-bordered"
                                 style="border: 3px !important; border-style: solid !important; border-color: #000000 !important;">
                            <thead>
                              <tr class="text-center">
                                <th colspan="5">CHI TIẾT GIÁ BÁN (tất cả số tiền được thể hiện bằng VNĐ)</th>
                              </tr>
                              <tr>
                                <tr class="text-center">
                                  <th>
                                    <div>Giá bán</div>
                                    <div>(A)</div>
                                  </th>
                                  <th>
                                    <div>Giá trị QSDĐ</div>
                                    <div>(Ghi chú 3)</div>
                                  </th>
                                  <th>
                                    <div>Tiền thuế (VAT)</div>
                                    <div>(B)</div>
                                  </th>
                                  <th>
                                    <div>Phí bảo trì</div>
                                    <div>(C)</div>
                                  </th>
                                  <th>
                                    <div>Tổng giá bán</div>
                                    <div>(A) + (B) + (C)</div>
                                  </th>
                                </tr>
                              </tr>
                            </thead>
                            <tbody>
                              <tr class="text-center">
                                <td><div t-field="doc.bsd_gia_ban" t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                                <td><div t-field="doc.bsd_tien_qsdd" t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                                <td><div t-field="doc.bsd_tien_thue" t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                                <td><div t-field="doc.bsd_tien_pbt" t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                                <td><div t-field="doc.bsd_tong_gia" t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                        <!-- Lịch thanh toán -->
                        <div class="row">
                          <table class="table table-bordered"
                                 style="border: 3px !important; border-style: solid !important; border-color: #000000 !important;">
                            <thead>
                              <tr class="text-center">
                                <th colspan="4">LỊCH THANH TOÁN</th>
                              </tr>
                              <tr>
                                <tr class="text-center">
                                  <th>
                                    <div>STT</div>
                                  </th>
                                  <th>
                                    <div>Đợt thanh toán</div>
                                  </th>
                                  <th>
                                    <div>Chi tiết thanh toán</div>
                                  </th>
                                  <th>
                                    <div>Số tiền (VNĐ)</div>
                                  </th>
                                </tr>
                              </tr>
                            </thead>
                            <tbody>
                              <tr class="text-center">
                                <td colspan="2">Đặt cọc</td>
                                <td><div/></td>
                                <td><div t-field="doc.bsd_du_an_id.bsd_tien_dc" t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                              </tr>
                              <t t-foreach="doc.bsd_ltt_ids.sorted(key=lambda l: l.bsd_stt)" t-as="line">
                                <t t-if="line.bsd_tinh_pbt">
                                  <tr class="text-center">
                                    <td rowspan="2"><div t-field="line.bsd_stt"/></td>
                                    <td rowspan="2"><div t-field="line.bsd_ten_dtt"/></td>
                                    <td><div t-field="line.bsd_cs_tt_ct_id.bsd_dien_giai"/></td>
                                    <td><div t-field="line.bsd_tien_dot_tt"  t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                                  </tr>
                                  <tr class="text-center">
                                    <td>
                                      <div>
                                        <span>Phí bảo trì</span>
                                      </div>
                                    </td>
                                    <td><div t-field="doc.bsd_tien_pbt"/></td>
                                  </tr>
                                </t>
                                <t t-else="">
                                  <tr class="text-center">
                                    <td><div t-field="line.bsd_stt"/></td>
                                    <td><div t-field="line.bsd_ten_dtt"/></td>
                                    <td><div t-field="line.bsd_cs_tt_ct_id.bsd_dien_giai"/></td>
                                    <td><div t-field="line.bsd_tien_dot_tt"  t-options='{"widget": "monetary", "display_currency": currency}'/></td>
                                  </tr>
                                </t>
                              </t>
                              <tr>
                                <td class="text-right" colspan="3"><b>Tổng giá bán:</b></td>
                                <td class="text-center"><div t-field="doc.bsd_tong_gia"/></td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                        <!-- Điều khoản-->
                        <div class="row">
                          <div><b><u>Điều khoản:</u></b></div>
                        </div>
                        <div class="row">
                          <ol>
                            <li>
                              <div>
                                <span>Phiếu tính giá này chỉ có hiệu lực đến ngày: </span>
                                <span t-field="doc.bsd_ngay_hh_kbg"/>
                              </div>
                            </li>
                            <li>
                              <div>
                                <span>Để xác nhận mua hàng, xin vui lòng ký vào phiếu tính giá này, gửi về <span t-field="doc.bsd_du_an_id.bsd_chu_dt_id.name"/>
                                  và hoàn thành đặt cọc số tiền <span t-field="doc.bsd_tien_dc"/> bằng tiền mặt và thẻ tính dụng hoặc chuyển khoản đến tài khoản
                                  công ty dự án theo thông tin dưới đây:</span>
                                <ul>
                                  <li><span>Chủ tài khoản           : </span></li>
                                  <li><span>Số tài khoản            : </span></li>
                                  <li><span>Tên tài khoản           : </span></li>
                                  <li><span>Chi nhánh               : </span></li>
                                  <li><span>Mã định danh ngân hàng  : </span></li>
                                </ul>
                              </div>
                            </li>
                            <li>
                              <div><span>Giá trị QSDĐ được ước tính bởi Chủ đầu tư và sẽ được xem xét lại bởi Cơ quan chức năng tại thời điểm bàn giao căn hộ.
                               Giá trị QSDĐ không bị tính thuế GTGT</span></div>
                            </li>
                            <li>
                              <div><span>Người nước ngoài được yêu cầu có mặt tại Việt Nam để ký Hợp đồng mua bán.</span></div>
                            </li>
                          </ol>
                        </div>
                        <!--Ký tên-->
                        <div class="row">
                          <div class="col-4 text-center">
                            <div class="mb-5" style="margin-bottom:200px">Người lập</div>
                            <div style="border-bottom: 1px solid black;"/>
                          </div>
                          <div class="col-4 text-center">
                            <div class="mb-5">Người duyệt</div>
                            <hr class="mt-5"/>
                          </div>
                          <div class="col-4 text-center">
                            <div class="mb-5">Xác nhận của khách hàng</div>
                            <hr class="mt-5"/>
                          </div>
                        </div>
                    </div>
                    </t>
                </t>
            </t>
        </template>
    </data>
</odoo>